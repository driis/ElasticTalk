# ElasticSearch talk notes

### Put in some data

Talk about JSON and Elastic being document-oriented.

```
PUT /employees/employee/5
{
    "name":"Mick Testguy",
    "age": 47,
    "interests": ["rock music","climbing"]
}
```
Puts the JSON document into the `employees` index, use type `employee` and assign id `5`.

Demonstrate:
* Leaving out the ID (autogenerate ID)
* Getting back the document
* 3 required metadata values _index, _type, and _id
* version - for optimistic concurrency control

Autogenerated IDs are 22 character long, URL-safe, Base64-encoded string universally unique identifiers, or UUIDs.

### Simple query string
#### Search all indexes for "john in any field"
```
GET /_search?q=john
```

#### Search for "john" in email:
```
GET /_search?q=email:john
```

#### Query DSL
```
POST /employees/employee/_search
{
    "query": {
        "match": {
           "name": "John"
        }
    }
    , "filter": {
        "range": {
           "age": {
              "to": 40
           }
        }
    }
}
```

#### Aggregations
```
POST shakespeare/line/_search?search_type=count
{
  "aggs":{
    "types":{
      "terms": {
        "field":"speaker"
      }
    }
  }
}


POST shakespeare/line/_search
{
  "filter":{
    "term":{
      "speaker":"BRUTUS"
    }
    },
    "aggs":{
      "plays":{
        "terms":{
          "field":"play_name"
        }
      }
    }
  }
```
